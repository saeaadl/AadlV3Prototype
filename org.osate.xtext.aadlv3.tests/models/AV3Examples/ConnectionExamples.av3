package ConnectionExamples 
// connections without and with reach down into is
// shared data component

	type systemstate;
	
	interface actuator is
		state: provides in data access systemstate;
		inp: in port;
		fea: feature;
	end
	interface sensor is
		state: requires in data access systemstate;
		outp: out port;
		fea: feature;
	end
	
	abstract sensor.i is
		sub1: thread sense;
		upmap: delegate sub1.p1 -> outp ;
		stateaccess: delegate sub1.state ->state ;
	end
	abstract actuator.i  is
		mystate: data systemstate ;
		sub2: thread actuate;
		downmap: delegate inp -> sub2.p1;
		stateread: delegate state -> mystate; 
		statewrite: connection sub2.state -> mystate ;
	end
	
	
	thread interface sense  is
		state: requires in data access systemstate;
		p1: out port ;
	end
	
	thread interface actuate  is
		p1: in port ;
		state: requires out data access systemstate;
	end
	
	system interface conntop end
	system conntop.i is
		sense: abstract sensor.i;
		actuate: abstract actuator.i;
		hw : system hardwareplatform.impl;
		conn1: connection sense.sub1.p1 -> actuate.sub2.p1;
		conn2: connection sense.outp -> actuate.inp;
		stateaccess: connection sense.state -> actuate.state ;
		fconn: connection sense.fea -> actuate.fea;
	end
	
	bus interface canbus is
	canbusaccess: provides bus access canbus;
	end
	
	processor interface x86 is
	canbusaccess: requires bus access canbus;
	end
	
	system interface hardwareplatform is
		canbusaccess: provides bus access canbus;
	end
	
	system hardwareplatform.impl is
	cpu: processor x86;
	mybus: bus canbus;
	busconn: connection cpu.canbusaccess <-> mybus.canbusaccess;
	extbusaccess: delegate canbusaccess <-> mybus.canbusaccess; 
	end
	
end